# Malware Lab Setup 

Oracle Virtual Box:
- you need to create an isolated network in Virtual Box so the malware you are analysing cannot escape and infect the host operating system 
- to do this you first need to setup an isolated network with
	- a) create a new network adapter: File -> Host Network Manager -> Create -> name "VirtualBox Host-Only Ethernet Adapter #2"
	- b) configure the adatper manually by setting IPv4 address and network mask (i.e. 10.0.0.1 and 255.255.255.0)
	- c) set the DHCP Server settings (i.e. server address 10.0.0.2, server mask 255.255.255.0, lower bound and upper bound address range)
	- d) apply the changes and save
- next, make sure each malware analysis VM only has this isolated network adapter enabled
- finally, make sure no clipboard or file sharing capabilities are enabled on any of the VMs you will by to analyse the malware with 

---

REMnux:
- REMnux is a Linux toolkit for reverse-engineering and analyzing malicious software. REMnux provides a curated collection of free tools created by the community. Analysts can use it to investigate malware without having to find, install, and configure the tools.
- it lets you simulate a Internet connection in your malware analysis lab (via INetSim) and use Linux tools to analyse malware
- the REMnux VM can be downloaded from [here](https://docs.remnux.org/install-distro/get-virtual-appliance)
- once downloaded change the network adapter to the "VirtualBox Host-Only Ethernet Adapter #2" to isolate the VM from the Internet and host machine
	- Network -> Adapter 1 -> Host-only Adapter -> VirtualBox Host-Only Ethernet Adapter #2
- once setup you need to make network configuration changes to the `/etc/inetsim/inetsim.conf` file:
	- uncomment the `start_service dns` line
	- uncomment and set the service bind address to `service_bind_address 0.0.0.0` (all interfaces)
	- uncomment and set the DNS default IP to `dns_default_ip <machine-ip>` (can find REMnux machine IP with `ip a`)
- take a Snapshot of the VM once all installation and configuration complete

---

FLARE VM:
- FLARE VM is a freely available and open sourced Windows-based security distribution designed for reverse engineers, malware analysts, incident responders, forensicators, and penetration testers,
- it lets you test malware in a Windows environment and installation instructions can be found [here](https://github.com/mandiant/flare-vm)
- once downloaded change the network adapter to the "VirtualBox Host-Only Ethernet Adapter #2" to isolate the VM from the Internet and host machine
- once installed you need to make network configuration settings in Network & Internet settings -> Change adapter options -> Ethernet -> Properties -> Internet Protocol Version 4 (TCP/IPv4) 
	- change the DNS server address to that of the Remux VM you have created so all DNS requests will go to this server and malware will think this server is the Internet
- once DNS is changed, setup INetSim on REMnux VM and navigate to any URL on FLARE VM to check that REMnux box is being used for DNS resolves and the defualt INetSim webpage is displayed
- take a Snapshot of the VM once all installation and configuration complete





