# Challenge 1 - SillyPutty 

> Perform basic static and basic dynamic analysis on this malware sample and extract facts about the malware's behavior. Answer the challenge quesitons below. If you get stuck, the `answers/` directroy has the answers to the challenge.


## Challenge Questions:

--- 
#### Basic Static Analysis:

1. What is the SHA256 hash of the sample?

0C82...EE83

2. What architecture is this binary?

32-bit

3. Are there any results from submitting the SHA256 hash to VirusTotal??

Yes - PowerShell dropper?

4. Describe the results of pulling the strings from this binary. Record and describe any strings that are potentially interesting. Can any interesting information be extracted from the strings?

- binary related to PuTTY
- URL: https://www.chiark.greenend.org.uk/~sgtatham/putty
- socks proxy strings 


5. Describe the results of inspecting the IAT for this binary. Are there any imports worth noting?

- clipboard related functions
- GetKeyboardState
- ShellExecuteA
- registry related functions
- process/thread related functions

6. Is it likely that this binary is packed?

No

--- 
#### Basic Dynamic Analysis

1. Describe initial detonation. Are there any notable occurances at first detonation? Without internet simulation? With internet simulation?

Without Internet simulation:
- putty configration windows appears
- some PowerShell files created/queried 
- runs PowerShell command

With Internet simulation:
- DNS query for bonus2.corporatebonusapplication.local
- connection made from TCP port 1069 to 8443 on remnuxserver
- setup netcat listener: url purported "bonus2.corporatebonusapplication.local"
- sets up reverse shell


2. From the host-based indicators perspective, what is the main payload that is initiated at detonation? What tool can you use to identify this?
- `powershell.exe ...`
- Procmon -> Process Tree


3. What is the DNS record that is queried at detonation?
- DNS query for bonus2.corporatebonusapplication.local

4. What is the callback port number at detonation?
- 8443

5. What is the callback protocol at detonation?
- TCP

6. How can you use host-based telemetry to identify the DNS record, port, and protocol?

7. Attempt to get the binary to initiate a shell on the localhost. Does a shell spawn? What is needed for a shell to spawn?



