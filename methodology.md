# Malware Analysis Methodology

### Malware Binary Analysis

1. basic static analysis:
	- get hashes and lookup on VT (i.e. in PowerShell prompt `Get-FileHash -Algorithm SHA256 <binary>`)
	- get strings (i.e. `floss <binary>.exe > <binary>.strings.txt`)
	- perform string analysis and note interesting strings
	- open binary in PEView and PEStudio to look at IAT and image header information
	- determine if malware is packed (use IAT, string analysis, PeID entropy, compare virtual size and raw on-disk size)

2. basic dynamic analysis:
	- setup all dynamic binary anlaysis tools (Procmon on host, Wireshark on remnux, INetSim on remnux, TCPView on host)
	- detonate the malware
	- search for host-based indicators (filter for events Procmon: files, registery interaction, details)
	- search for network-based indicators (in Procmon TCP in Operation, in Wireshark use the highest protocol avaliable and follow TCP/HTTP streams, in TCPView look for new sockets)
	- during basic dynamic analysis you will do rounds of analysis to find different indicators; you will restore the analysis VM to a pre-detonation state, detonate, collect indicators of what the malware does, restore VM, then detonate again and collect other indicators

3. advanced static analysis 
	- open malware in Cutter
	- find main function (may be dependent on what programming language malware is writter in, i.e. nim = NimMainInner) and right click -> Show In -> New graph to get a basic overview of the malware
	- look for where interesting strings are called in the disassembly to reveal their possible usage 
	- cross compare diassembly with other analysis techniques to confirm functionality (i.e. network-based and host-based indicators from basic analysis)

4. advanced dynamic analysis
	- open malware in x32dbg or x64dbg 
	- press run (F9) to get to the entry point of the program
	- step through program and cross compare host/network-based indicators to reveal functionality of malware 
	- change flag/registry values to get the malware to behave how you want it to 


---

### Maldoc Analysis

1. ... 



### Shellcode Analysis



### Scripted Malware Delivery Mechanisms 



### C# Malware Analysis 




### Mobile Malware Analysis 



### Automated Analysis






### Rule Writing & Reporting


